# code explanation for Script_beta.R
----------------------------------------

The data obtained through the Bash [script](../Scripts_bash/Script_binary_table.sh) can be used in RStudio to perform a beta diversity analysis and generate visualizations based on a binary presence/absence matrix of bacterial taxa. We begin by loading the libraries: tidyverse for data manipulation, vegan for ecological distance calculations, and ape for phylogenetic analyses. The presence/absence matrix, named [taxa_presence_absence_min10.tsv](../data/taxa_presence_absence_min10.tsv) (this file is provided as an example; the original file is too large to be hosted on the GitHub platform), is imported using the read.delim function, with the first column set as row names. The matrix is then transposed so that rows represent samples and columns represent taxa. A filtering step is applied to remove samples (rows) that contain no taxa (i.e., row sums equal to zero), which helps to avoid statistical issues in subsequent analyses.
On this filtered matrix, a Jaccard distance is calculated using the vegdist function with the option binary = TRUE, which is specifically suited for binary data. This distance measures dissimilarity in taxonomic composition between samples. It is particularly relevant in ecological contexts, as it focuses on differences in community composition based solely on presence or absence, without considering abundance (Legendre & De CÃ¡ceres, 2013).
A principal coordinates analysis (PCoA) is then performed using the cmdscale function to reduce the dimensionality of the data and to visualize relationships between samples in a two-dimensional space. The resulting coordinates are converted into a data frame, annotated with sample names, and visualized using ggplot2, displaying both data points and their corresponding labels. The resulting plot allows for the examination of potential clustering patterns among samples based on their bacterial composition.
Finally, a dendrogram is generated from the Jaccard distance matrix using the hclust function, in order to represent the hierarchical relationships in similarity among the samples. This complementary approach facilitates a clearer visualization of sample groupings that share similar bacterial taxonomic profiles.

