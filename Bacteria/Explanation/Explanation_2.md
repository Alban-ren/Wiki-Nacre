# code explanation for Script_beta.R
----------------------------------------

The data obtained through the Bash [script](../Scripts_bash/Script_binary_table.sh) can be used in RStudio to perform a beta diversity analysis and generate visualizations based on a binary presence/absence matrix of bacterial taxa. We begin by loading the libraries: tidyverse for data manipulation, vegan for ecological distance calculations, and ape for phylogenetic analyses. The presence/absence matrix, named [taxa_presence_absence_min10.tsv](../data/taxa_presence_absence_min10.tsv), is imported using the read.delim function, with the first column set as row names (this file is provided as an example; the original file is too large to be hosted on the GitHub platform). The matrix is then transposed so that rows represent samples and columns represent taxa. A filtering step is applied to remove samples (rows) that contain no taxa (i.e., row sums equal to zero), which helps to avoid statistical issues in subsequent analyses.
On this filtered matrix, a Jaccard distance is calculated using the vegdist function with the option binary = TRUE, which is specifically suited for binary data. This distance measures dissimilarity in taxonomic composition between samples. It is particularly relevant in ecological contexts, as it focuses on differences in community composition based solely on presence or absence, without considering abundance (Legendre & De Cáceres, 2013).

This distance matrix is used to perform a Principal Coordinates Analysis (PCoA), the results of which are stored in a data frame enriched with sample group information. These groups are defined based on sample names (P1 to P43), and categorized into groups "F", "G", "I", and "S".

The PCoA results are visualized using ggplot2 as a scatter plot, with ellipses representing the groups, specific color coding, and sample labels. To assess the significance of group differences, a PERMANOVA is conducted using the adonis2 function, and a test for homogeneity of dispersions (betadisper) is also performed to validate the robustness of the results. The outcomes are summarized in a table displaying the R² or F values along with the associated p-values.

Finally, the script includes a pairwise analysis between groups using a custom function that performs PERMANOVA for all group combinations. The results are compiled into a summary table and visualized as a heatmap of p-values, highlighting statistically significant comparisons through a color gradient.

