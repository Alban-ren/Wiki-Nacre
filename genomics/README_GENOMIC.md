# Assembling the 'clean' transcriptomes  of *Pinna nobilis* and *Pinna rudis* species
------------------------------------------------------------------------
This section describes the pipelines developed for the assembly and annotation of genomic and transcriptomic data from Pinna nobilis and Pinna rudis. The objective of these assemblies was not to study differential gene expression directly, but rather to generate high-quality reference assemblies to support downstream analyses such as gene annotation, immune gene identification, and comparative studies of resistance mechanisms.

The datasets used for these assemblies included both transcriptomic short-read data and genomic long-read data. Public transcriptomic data were retrieved from NCBI SRA databases, consisting of paired-end RNA-seq reads ranging from 50 to 300 base pairs. In parallel, long-read genomic data were generated within the EMBIO laboratory, including samples from 38 P. nobilis, 1 P. rudis, and 4 hybrids collected across several Mediterranean sites: France, Spain, Italy, and Greece.

All raw datasets were first subjected to preprocessing steps aimed at removing potential contamination and ensuring high sequence quality. Contaminant bacterial reads were identified using [Kraken2](./Kraken_2.md#Kraken2) and SeqKit, which detect, identify, and remove potential bacterial contaminations from a database containing most of the known marine bacteria (see the [script](./Script_classification.md) section for more details on the code) . TThe remaining reads were then assessed for quality using [FastQC](./FastQC.md#FastQC). Low-quality sequences were trimmed with Trimmomatic to eliminate unreliable base calls at read ends, followed by a second FastQC check to validate improvements in read quality. 

For the transcriptomic assemblies, cleaned short-read RNA-seq data were assembled de novo using Trinity, which reconstructs full-length transcript sequences without the need for a reference genome. The completeness of these transcriptome assemblies was evaluated using BUSCO by searching for conserved single-copy orthologous genes expected in mollusks, thus providing a quantitative measure of assembly quality.

For the genomic assemblies, long-read DNA sequences were processed separately. These long reads were assembled with Flye, a genome assembler optimized for long-read technologies. Redundancy in the resulting contigs was addressed using Purge_dups, which removes duplicated sequences arising from assembly artifacts. Scaffolding was performed with P_RNA_Scaffolder, which utilizes paired transcriptomic alignments to connect contigs and improve assembly continuity. The final assembly quality was evaluated both in terms of gene content (BUSCO) and structural metrics (QUAST), including statistics such as N50 and L50 that reflect contig contiguity.

Following assembly, gene prediction and annotation were performed. Open reading frames were identified with ORF Finder, allowing for the prediction of putative coding sequences. Structural gene annotation was carried out with BRAKER3, which integrates RNA-seq alignments and homology evidence to generate gene models. Finally, predicted proteins were functionally annotated using DIAMOND against the UniProt reference database, enabling putative functional assignments through homology-based annotation.

The high-quality transcriptomic and genomic assemblies produced in this workflow served as essential resources for downstream analyses, including the identification and classification of Toll-like receptors (TLRs), as well as the exploratory characterization of tissue-associated bacterial communities.

All scripts and pipelines developed for these analyses—including preprocessing, assembly, annotation, and quality control steps—are available in the [genomics](.) folder of this repository. These resources were developed using Bash and R, and aim to ensure full reproducibility for future research on *Pinna spp*. genomic resistance mechanisms.
