## Kraken2
-----------
Kraken 2 is an ultra-fast software tool designed for taxonomic classification of DNA or RNA sequences derived from metagenomic data. It enables the identification and labeling of organisms present in a biological sample, down to the species level (Wood & Salzberg, 2014).
Kraken 2 is an improved version of the original Kraken, which relied on a memory-intensive algorithm with a fixed k-mer length (Wood et al., 2019).
A k-mer is defined as a contiguous sequence of amino acids or nucleotides of fixed length k (Moeckel et al., 2023). In practice, Kraken 2 splits input sequences into k-mers, compares them to a pre-built database, and assigns each read to a specific taxon using a high-speed lowest common ancestor (LCA) algorithm.

In our study, Kraken 2 was used to identify bacterial taxa present in the transcriptome of Pinna nobilis and Pinna rudis, with their relative abundance expressed as a percentage for each taxon. However, Kraken 2 is a classifier, and its estimates of taxonomic abundance are only approximate. 

Kraken 2 script 
--
kraken2 --db kraken2/name_db/ --use-names --threads n --confidence n --report file/report_name.txt --output file/output_name.txt file/sample_name

* name_db is the name of the database containing the taxa to be compared.
* --use-names command indicates that the taxon names from the database are used.
* --threads 30 means that n processor cores are allocated in parallel for Kraken 2 to accelerate the execution of the program.
* --confidence n defines the minimum confidence threshold for a read to be assigned to a specific taxon.
* name_report.txt is the taxonomic summary report generated by Kraken 2.Includes the percentage of reads assigned to each taxon, taxonomy levels, taxon names, and read counts for the sample.
* output_name is the detailed read-level classification file. Each line corresponds to a read, indicating whether it was classified (C) or unclassified (U), along with the assigned taxon.
* sample_name is the name of the sample tested.

You can see the entire script we used for our sample in the [experiment](./Experiment_01.md#experiment-script) section.

To achieve more accurate quantification of bacterial taxa from a sample, the complementary software Bracken is required.
Bracken allows more precise estimation of alpha and beta diversity, even at the species level (Lu et al., 2022). That said, Bracken is typically used in contexts where target species are directly amplified, such as through PCR-based techniques.
In our case, the sequences analyzed originate from host transcriptomes (Pinna spp.), and not from bacterial DNA specifically extracted or enriched. Therefore, Bracken results may be biased, and the resulting abundance data should be interpreted as indicative rather than quantitative.
